
### **系统角色与权限设计**

#### **1. 学生用户**

|权限|功能描述|
|---|---|
|成果登记|填写成果信息（名称、类型、时间、指导教师等），上传佐证材料（奖状、论文截图），选择所属队长。|
|成果管理|查看已提交成果状态（待审/通过/退回），修改被退回成果并重新提交，删除草稿。|
|成果查询与统计|按时间、类型、级别、班级等条件筛选成果，查看统计图表（类型分布、年度趋势），导出Excel/PDF清单。|

#### **2. 队长用户**

|权限|功能描述|
|---|---|
|成果审核|查看本队学生提交的成果，审核操作包括“通过”“退回”“拒绝”，填写审核意见，记录审核历史。|
|成果统计与管理|按条件筛选成果，修改成果级别或备注，统计本队成果数量，导出Excel报表。|

#### **3. 管理员

| 权限   | 功能描述                          |
| ---- | ----------------------------- |
| 系统配置 | 设置成果分类、奖项级别、班级/年级映射关系，管理用户权限。 |
| 数据监控 | 查看全量成果数据，设置公开访问权限，处理异常数据。     |


---

### **功能模块设计与实现细节**

#### **（一）学生端功能**

1. **成果登记页面**
    
    - **字段设计**：
        - 成果名称（必填，文字输入框）
        - 类型（下拉选择：论文/竞赛/项目/荣誉）
        - 获奖级别（下拉选择：校级/省部级/国家级）
        - 获奖时间（日期选择器）
        - 指导教师（文字输入框，支持多选）
        - 成员名单（关联学生数据库，支持多选或手动输入）
        - 所属班级/年级（自动关联学生账号信息）
        - 所属队长（下拉选择或手动填写队长账号）
        - 佐证材料（多文件上传，支持PDF/JPG/PNG格式，最大容量50MB）
    - **操作流程**：
        - 点击“保存草稿”暂存未提交内容；
        - 点击“提交审核”后，系统自动生成成果ID，并将任务分配至对应队长审核队列。
2. **我的成果页面**
    
    - **状态分类**：
        - 待审：提交后未被队长处理；
        - 通过：审核通过并进入成果库；
        - 退回：需根据审核意见修改后重新提交；
        - 拒绝：无法再次提交（需管理员介入）。
    - **操作功能**：
        - 修改：仅限“草稿”或“退回”状态的成果；
        - 删除：仅限“草稿”状态的成果。
3. **成果查询与统计**
    
    - **筛选条件**：
        - 时间范围（年份/季度/月份）
        - 成果类型、获奖级别、所属班级、队长
    - **图表展示**：
        - 类型分布：饼图（占比显示）
        - 年度趋势：折线图（逐年/逐月统计）
        - 各班对比：柱状图（班级间成果数量对比）
    - **导出功能**：
        - Excel：包含完整字段列表；
        - PDF：图表与关键数据摘要。

#### **（二）队长端功能**

1. **成果审核页面**
    
    - **审核流程**：
        - 查看成果详情（名称、类别、佐证材料）；
        - 操作按钮：
            - **通过**：成果直接进入成果库；
            - **退回**：填写修改意见（文本框），成果状态变为“退回”；
            - **拒绝**：填写拒绝理由（文本框），成果状态变为“拒绝”。
    - **审核记录**：
        - 自动记录每次操作时间、审核人、操作类型及意见。
2. **成果统计与管理**
    
    - **筛选与编辑**：
        - 按条件筛选成果后，可修改“获奖级别”或添加备注说明；
        - 批量操作：导出Excel报表、设置是否公开展示。

#### **（三）成果展示与统计模块**

- **展示形式**：
    - 列表视图：显示成果名称、类型、获奖级别、所属班级；
    - 图表视图：支持年度折线图、类型饼图、班级对比柱状图。
- **访问权限**：
    - 默认仅限本校用户访问；
    - 公开展示需队长或管理员手动开启。
- **响应式设计**：
    - 支持PC端与移动端自适应布局，确保在不同设备上操作流畅。

---

### **数据结构（PostgreSQL）**

| **表名**           | **字段名**          | **数据类型**     | **约束**                                                              | **说明**                                                           |
| ---------------- | ---------------- | ------------ | ------------------------------------------------------------------- | ---------------------------------------------------------------- |
| **users**        | `user_id`        | UUID         | `PRIMARY KEY`                                                       | 用户唯一ID（系统自动生成UUID）                                               |
|                  | `username`       | VARCHAR(50)  | `UNIQUE`, `NOT NULL`                                                | 学号/工号                                                            |
|                  | `password_hash`  | VARCHAR(100) | `NOT NULL`                                                          | 密码哈希（BCrypt加密）                                                   |
|                  | `role`           | VARCHAR(20)  | `CHECK (role IN ('student', 'team_leader', 'admin'))`               | 角色：学生/队长/管理员                                                     |
|                  | `name`           | VARCHAR(50)  | `NOT NULL`                                                          | 姓名                                                               |
|                  | `class_id`       | UUID         | `FOREIGN KEY REFERENCES classes(class_id)`                          | 所属班级（学生必填，队长关联班级）                                                |
| **classes**      | `class_id`       | UUID         | `PRIMARY KEY`                                                       | 班级唯一ID                                                           |
|                  | `class_name`     | VARCHAR(50)  | `NOT NULL`                                                          | 班级名称                                                             |
|                  | `college`        | VARCHAR(30)  | `NOT NULL`                                                          | 所属学院                                                             |
| **achievements** | `achievement_id` | UUID         | `PRIMARY KEY`                                                       | 成果唯一ID                                                           |
|                  | `title`          | VARCHAR(200) | `NOT NULL`                                                          | 成果名称                                                             |
|                  | `type`           | VARCHAR(20)  | `CHECK (type IN ('paper', 'competition', 'project', 'honor'))`      | 类型：论文/竞赛/项目/荣誉                                                   |
|                  | `level`          | VARCHAR(20)  | `CHECK (level IN ('school', 'province', 'national'))`               | 级别：校级/省部级/国家级                                                     |
|                  | `award_date`     | DATE         | `NOT NULL`                                                          | 获奖时间                                                             |
|                  | `supervisor`     | VARCHAR(100) |                                                                     | 指导教师（可多选，存储为字符串）                                                 |
|                  | `members`        | JSONB        |                                                                     | 成员名单（存储学生ID数组，如：`['user1', 'user2']`）                            |
|                  | `class_id`       | UUID         | `FOREIGN KEY REFERENCES classes(class_id)`                          | 所属班级（自动关联班级表）                                                    |
|                  | `leader_id`      | UUID         | `FOREIGN KEY REFERENCES users(user_id)`                             | 所属队长ID（学生提交时填写）                                                  |
|                  | `evidence_files` | JSONB        |                                                                     | 佐证材料（存储文件路径数组，如：`['/uploads/award1.pdf', '/uploads/paper.jpg']`） |
|                  | `status`         | VARCHAR(20)  | `CHECK (status IN ('pending', 'approved', 'rejected', 'returned'))` | 状态：待审/通过/拒绝/退回                                                   |
|                  | `is_public`      | BOOLEAN      | `DEFAULT FALSE`                                                     | 是否公开展示（默认不公开）                                                    |
|                  | `created_at`     | TIMESTAMP    | `DEFAULT NOW()`                                                     | 提交时间                                                             |
| **logs**         | `log_id`         | UUID         | `PRIMARY KEY`                                                       | 审核日志ID                                                           |
|                  | `achievement_id` | UUID         | `FOREIGN KEY REFERENCES achievements(achievement_id)`               | 关联成果ID                                                           |
|                  | `auditor_id`     | UUID         | `FOREIGN KEY REFERENCES users(user_id)`                             | 审核人ID（队长）                                                        |
|                  | `action`         | VARCHAR(20)  | `CHECK (action IN ('approve', 'return', 'reject'))`                 | 操作：通过/退回/拒绝                                                      |
|                  | `comment`        | TEXT         |                                                                     | 审核意见（退回/拒绝时必填）                                                   |
|                  | `audit_time`     | TIMESTAMP    | `DEFAULT NOW()`                                                     | 审核时间                                                             |

---


